Parfait â€” voici une procÃ©dure complÃ¨te, propre et exploitable en PROD pour installer Hawtio sur Tomcat, avec SSL et authentification LDAP, sous Linux.

Je te la donne pas Ã  pas, sans raccourci.


---

ğŸ§© Architecture cible

Navigateur
   â†“ HTTPS
Tomcat (SSL + LDAP)
   â†“
Hawtio (WAR)
   â†“
JMX (BW, JVM, IBM MQ, etc.)


---

1ï¸âƒ£ PrÃ©requis

Linux

Java 11 ou 17 (Java 8 possible mais moins recommandÃ©)

Tomcat 9.x (idÃ©al)

AccÃ¨s Ã  un LDAP / Active Directory

Ports ouverts :

8443 (HTTPS Tomcat)

ports JMX cibles




---

2ï¸âƒ£ Installation de Tomcat

useradd -r -m -U -d /opt/tomcat -s /bin/false tomcat
cd /opt
wget https://downloads.apache.org/tomcat/tomcat-9/v9.0.xx/bin/apache-tomcat-9.0.xx.tar.gz
tar xzf apache-tomcat-9.0.xx.tar.gz
ln -s apache-tomcat-9.0.xx tomcat
chown -R tomcat:tomcat apache-tomcat-9.0.xx tomcat


---

3ï¸âƒ£ GÃ©nÃ©rer le keystore SSL

keytool -genkeypair \
  -alias tomcat \
  -keyalg RSA \
  -keysize 2048 \
  -keystore /opt/tomcat/conf/tomcat.jks \
  -validity 825


---

4ï¸âƒ£ Activer HTTPS dans Tomcat

Ã‰diter :
/opt/tomcat/conf/server.xml

Ajouter :

<Connector
  port="8443"
  protocol="org.apache.coyote.http11.Http11NioProtocol"
  maxThreads="150"
  SSLEnabled="true">

  <SSLHostConfig>
    <Certificate
      certificateKeystoreFile="conf/tomcat.jks"
      certificateKeystorePassword="changeit"
      type="RSA" />
  </SSLHostConfig>
</Connector>


---

5ï¸âƒ£ TÃ©lÃ©charger et dÃ©ployer Hawtio WAR

cd /opt/tomcat/webapps
wget https://repo1.maven.org/maven2/io/hawt/hawtio-default/2.x.y/hawtio-default-2.x.y.war
mv hawtio-default-2.x.y.war hawtio.war
chown tomcat:tomcat hawtio.war


---

6ï¸âƒ£ Configuration LDAP (JAAS)

6.1 CrÃ©er le fichier JAAS

ğŸ“„ /opt/tomcat/conf/jaas.conf

hawtio {
  com.sun.security.auth.module.LdapLoginModule required
  userProvider="ldap://ldap.example.com:389/ou=users,dc=example,dc=com"
  authIdentity="{USERNAME}"
  useSSL=false
  debug=false;
};

(Si LDAPS, mets useSSL=true et port 636)


---

6.2 DÃ©clarer JAAS dans Tomcat

ğŸ“„ /opt/tomcat/bin/setenv.sh

export CATALINA_OPTS="
 -Djava.security.auth.login.config=/opt/tomcat/conf/jaas.conf
"


---

7ï¸âƒ£ SÃ©curiser Hawtio par LDAP

ğŸ“„ /opt/tomcat/webapps/hawtio/WEB-INF/web.xml

Ajouter avant </web-app> :

<security-constraint>
  <web-resource-collection>
    <web-resource-name>Hawtio</web-resource-name>
    <url-pattern>/*</url-pattern>
  </web-resource-collection>
  <auth-constraint>
    <role-name>hawtio</role-name>
  </auth-constraint>
</security-constraint>

<login-config>
  <auth-method>BASIC</auth-method>
  <realm-name>hawtio</realm-name>
</login-config>

<security-role>
  <role-name>hawtio</role-name>
</security-role>


---

8ï¸âƒ£ Mapper LDAP â†’ rÃ´le Hawtio

ğŸ“„ /opt/tomcat/conf/context.xml

<Realm className="org.apache.catalina.realm.JAASRealm"
       appName="hawtio"
       userClassNames="com.sun.security.auth.module.LdapLoginModule"
       roleClassNames="com.sun.security.auth.module.LdapLoginModule" />


---

9ï¸âƒ£ DÃ©marrer Tomcat

su - tomcat
/opt/tomcat/bin/startup.sh

AccÃ¨s :

https://<host>:8443/hawtio


---

ğŸ” 10ï¸âƒ£ SÃ©curitÃ© JMX (important)

Sur les JVM cibles (BW, MQ, etc.) :

-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=9010
-Dcom.sun.management.jmxremote.rmi.port=9010
-Dcom.sun.management.jmxremote.authenticate=true
-Dcom.sun.management.jmxremote.ssl=false

â¡ï¸ Utilise le mÃªme LDAP ou un autre mÃ©canisme JMX sÃ©curisÃ©.


---

âœ… Checklist finale PROD

âœ”ï¸ HTTPS actif
âœ”ï¸ LDAP obligatoire
âœ”ï¸ Pas dâ€™accÃ¨s HTTP
âœ”ï¸ Firewall IP
âœ”ï¸ Comptes LDAP restreints
âœ”ï¸ Logs Tomcat surveillÃ©s


---

Tu veux aller plus loin ?

Je peux te fournir :

ğŸ”’ version LDAPS + truststore

ğŸ§° version Nginx â†’ Tomcat â†’ Hawtio

ğŸ§  config Hawtio pour BW 5 / IBM MQ

ğŸ“‹ checklist audit sÃ©curitÃ©


Dis-moi ğŸ‘
