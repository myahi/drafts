# ============================================================
# APPLICATION CONFIGURATION
# ============================================================
spring:
  application:
    name: eai-bofi-rgv
  jmx:
    enabled: true
  datasource:
    url: jdbc:oracle:thin:@src4eai01.f1nom0a.local:1521/rc1maes1
    username: maestro
    password: MPW0d-veAdK_42zKtC36
    driver-class-name: oracle.jdbc.OracleDriver

project:
  name: RGV

# ============================================================
# AUDIT & ERROR CONFIGURATION
# ============================================================
audit:
  destination: ems # "seda" ou "ems"
  logging:
    enabled: false # Ne pas logger les audits (déjà dans EMS)

error:
  destination: ems # "seda" ou "ems"
  auto-audit:
    enabled: true
  logging:
    enabled: true
    level: ERROR
    include-stacktrace: true

# ============================================================
# TIBCO EMS CONFIGURATION
# ============================================================
tibco:
  ems:
    server-url: tcp://src4ems01.marches.intra.laposte.fr:7222
    username: USR_SVC_EMS_APP_QLF
    password: yo0ng80l7a
    pool:
      enabled: true
      max-connections: 10
    queues:
      audit: AUDIT.QUEUE
      error: ERROR.QUEUE
    reconnect:
      attempts: 3
      delay: 5000

# ============================================================
# RGV SOAP CONFIGURATION
# ============================================================
rgv:
  soap:
    routeId: rgv-soap-route
    route:
      id: rgv-soap-service
    url: http://127.0.0.1:1120/RGV/formatter-service

# ============================================================
# CAMEL CONFIGURATION
# ============================================================
camel:
  springboot:
    name: eai-bofi-rgv
    main-run-controller: true
    micrometer:
      enabled: true

# ============================================================
# MANAGEMENT / ACTUATOR
# ============================================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,camel
  metrics:
    enable:
      all: true
  endpoint:
    camel:
      enabled: true
      show-extended-info: true

# ============================================================
# SERVER
# ============================================================
server:
  port: 8080

# ============================================================
# LOGGING CONFIGURATION
# ============================================================
logging:
  pattern:
    console: "%d{HH:mm:ss.SSS} %highlight{%-5level}{FATAL=red, ERROR=red, WARN=yellow, INFO=green, DEBUG=cyan} [%thread] %logger{36} - %X{correlationId} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%thread] %logger{36} - correlationId=%X{correlationId} userId=%X{userId} executionId=%X{executionId} - %msg%n"
  file:
    name: logs/eai-bofi-rgv.log
  level:
    root: INFO
    fr.lbp: INFO
    fr.lbp.lib.audit: INFO
    fr.lbp.lib.error: ERROR
    fr.lbp.lib.ems: INFO
    fr.lbp.routes: INFO
    org.apache.camel: WARN
    org.apache.cxf: WARN
    org.springframework: WARN
    org.hibernate: WARN
    com.zaxxer.hikari: WARN
  logback:
    rollingpolicy:
      max-file-size: 50MB
      max-history: 30
      total-size-cap: 1GB

# ============================================================
# PROFILES CONFIGURATION
# ============================================================
---
# ========== PROFILE: dev ==========
spring:
  config:
    activate:
      on-profile: dev

audit:
  destination: seda
  logging:
    enabled: true

error:
  destination: seda
  logging:
    level: ERROR
    include-stacktrace: true

tibco:
  ems:
    server-url: tcp://localhost:7222
    username: admin
    password: admin

logging:
  level:
    root: DEBUG
    fr.lbp: DEBUG
    org.apache.camel: INFO
  pattern:
    console: "%d{HH:mm:ss.SSS} %clr(%5p) %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %X{correlationId} - %m%n"

---
# ========== PROFILE: prod ==========
spring:
  config:
    activate:
      on-profile: prod

audit:
  destination: ems
  logging:
    enabled: false

error:
  destination: ems
  logging:
    level: ERROR
    include-stacktrace: false

tibco:
  ems:
    server-url: tcp://ems-prod1:7222,tcp://ems-prod2:7222
    username: ${EMS_USERNAME}
    password: ${EMS_PASSWORD}
    pool:
      max-connections: 20

logging:
  level:
    root: INFO
    fr.lbp: INFO
    org.apache.camel: WARN
    org.springframework: WARN
  file:
    name: /var/log/tibco-integration/app.log
  logback:
    rollingpolicy:
      max-file-size: 100MB
      max-history: 90
