Parfait ğŸ‘
VoilÃ  la version correcte et prÃªte-prod pour Spring Boot 3.x + Active Directory, toujours avec une seule classe et des properties.


---

âœ… application.properties (Spring Boot 3 + AD)

### Active Directory
spring.ldap.urls=ldap://ad.mycompany.local:389
spring.ldap.base=dc=mycompany,dc=local
spring.ldap.username=svc_ldap@mycompany.local
spring.ldap.password=secret

# Utilisateurs AD
spring.security.ldap.user-search-base=ou=users
spring.security.ldap.user-search-filter=(sAMAccountName={0})

# Groupes AD
spring.security.ldap.group-search-base=ou=groups
spring.security.ldap.group-search-filter=(member={0})

### Groupe AD autorisÃ© Ã  gÃ©rer Camel
security.camel.admin-group=CAMEL_ADMINS

### Hawtio / Jolokia
hawtio.authenticationEnabled=true
management.endpoints.web.exposure.include=hawtio,jolokia

> âš ï¸ Le groupe AD CAMEL_ADMINS sera exposÃ© comme
ROLE_CAMEL_ADMINS cÃ´tÃ© Spring Security.




---

âœ… Classe UNIQUE de sÃ©curitÃ© (Spring Boot 3.x)

@Configuration
@EnableWebSecurity
public class JolokiaSecurityConfig {

  @Value("${security.camel.admin-group}")
  private String adminGroup;

  @Bean
  SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {

    http
      .csrf(csrf -> csrf.disable())
      .authorizeHttpRequests(auth -> auth
        .requestMatchers("/actuator/**").permitAll()
        .requestMatchers("/hawtio/**").authenticated()
        .requestMatchers("/jolokia/**")
          .hasAuthority("ROLE_" + adminGroup)
        .anyRequest().denyAll()
      )
      .httpBasic(Customizer.withDefaults());

    return http.build();
  }
}


---

ğŸ” Points importants (AD)

sAMAccountName = login Windows

member={0} fonctionne si ton AD retourne le DN utilisateur

Si ton AD est capricieux, on peut passer Ã  :

(member:1.2.840.113556.1.4.1941:={0})

(groupes imbriquÃ©s)



---

âœ… RÃ©sultat final

âœ”ï¸ Spring Boot 3 compatible
âœ”ï¸ Active Directory natif
âœ”ï¸ Hawtio UI libre
âœ”ï¸ JMX/Jolokia sÃ©curisÃ©
âœ”ï¸ Start/Stop Camel autorisÃ© uniquement aux membres AD
âœ”ï¸ UX simple (popup unique)


---

ğŸ”’ Option recommandÃ©e (mais facultative)

Pour Ã©viter les surprises AD :

spring.security.ldap.authorities-populator.ignore-partial-result-exception=true


---

Si tu veux, je peux aussi te fournir :

la version SSL LDAPS

la config groupes imbriquÃ©s AD

ou la rÃ©cupÃ©ration du username pour lâ€™audit DB (UPDATED_BY)
